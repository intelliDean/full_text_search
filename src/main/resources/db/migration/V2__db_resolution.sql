insert into users (first_name, last_name, story) values ('Alonzo', 'Hansana', 'Focused user-facing superstructure');
insert into users (first_name, last_name, story) values ('Bar', 'Cogman', 'Phased non-volatile secured line');
insert into users (first_name, last_name, story) values ('Rakel', 'Leaf', 'Organized disintermediate capability');
insert into users (first_name, last_name, story) values ('Billye', 'Gauvin', 'Reduced system-worthy knowledge user');
insert into users (first_name, last_name, story) values ('Jess', 'Blakelock', 'Digitized zero tolerance emulation');
insert into users (first_name, last_name, story) values ('Cristian', 'Comrie', 'Switchable discrete help-desk');
insert into users (first_name, last_name, story) values ('Bobbette', 'Clothier', 'Implemented stable challenge');
insert into users (first_name, last_name, story) values ('Any', 'Turley', 'Expanded holistic Graphical User Interface');
insert into users (first_name, last_name, story) values ('Karlik', 'Sharples', 'Compatible static matrices');
insert into users (first_name, last_name, story) values ('Lancelot', 'Karlmann', 'Seamless discrete interface');
insert into users (first_name, last_name, story) values ('Evey', 'Tozer', 'Quality-focused content-based ability');
insert into users (first_name, last_name, story) values ('Yasmin', 'Scamel', 'Versatile static leverage');
insert into users (first_name, last_name, story) values ('Nada', 'Bold', 'Intuitive zero administration emulation');
insert into users (first_name, last_name, story) values ('Lisabeth', 'McQuillan', 'User-friendly interactive knowledge user');
insert into users (first_name, last_name, story) values ('Winn', 'Hewkin', 'Extended even-keeled structure');
insert into users (first_name, last_name, story) values ('Crista', 'Brunsden', 'Optimized explicit software');
insert into users (first_name, last_name, story) values ('Herold', 'Greatorex', 'Re-engineered responsive intranet');
insert into users (first_name, last_name, story) values ('Wilhelm', 'Chevers', 'Integrated object-oriented array');
insert into users (first_name, last_name, story) values ('Newton', 'Cattermole', 'Universal modular structure');
insert into users (first_name, last_name, story) values ('Yuma', 'Merrgan', 'Secured intangible knowledge base');
insert into users (first_name, last_name, story) values ('Olivette', 'Oggers', 'Proactive local support');
insert into users (first_name, last_name, story) values ('Tan', 'Mohun', 'User-friendly next generation process improvement');
insert into users (first_name, last_name, story) values ('Howard', 'Forde', 'Multi-layered clear-thinking portal');
insert into users (first_name, last_name, story) values ('Ginelle', 'Vergine', 'Cross-group neutral database');
insert into users (first_name, last_name, story) values ('Kath', 'Catford', 'Balanced contextually-based productivity');
insert into users (first_name, last_name, story) values ('Lorianna', 'Whitney', 'Ameliorated attitude-oriented project');
insert into users (first_name, last_name, story) values ('Bamby', 'Gallard', 'Front-line 24 hour Graphic Interface');
insert into users (first_name, last_name, story) values ('Livvy', 'Godwyn', 'Customer-focused impactful open architecture');
insert into users (first_name, last_name, story) values ('Teodor', 'Bumford', 'Implemented modular projection');
insert into users (first_name, last_name, story) values ('Terri', 'Yearron', 'Enhanced responsive strategy');
insert into users (first_name, last_name, story) values ('Nicol', 'Crumley', 'Innovative content-based help-desk');
insert into users (first_name, last_name, story) values ('Stafford', 'Middleditch', 'Universal composite methodology');
insert into users (first_name, last_name, story) values ('Saxe', 'Coughan', 'Configurable incremental intranet');
insert into users (first_name, last_name, story) values ('Pancho', 'Harmson', 'Expanded eco-centric time-frame');
insert into users (first_name, last_name, story) values ('Cchaddie', 'Lechmere', 'Ameliorated intermediate Graphic Interface');
insert into users (first_name, last_name, story) values ('Jaime', 'MacIver', 'Right-sized real-time forecast');
insert into users (first_name, last_name, story) values ('Rivy', 'Burkin', 'Organized heuristic info-mediaries');
insert into users (first_name, last_name, story) values ('Becky', 'Boutwell', 'Enterprise-wide 4th generation synergy');
insert into users (first_name, last_name, story) values ('Miquela', 'Orridge', 'Triple-buffered directional extranet');
insert into users (first_name, last_name, story) values ('Thorny', 'Han', 'Compatible zero administration process improvement');
insert into users (first_name, last_name, story) values ('Dominick', 'Garbett', 'Synergistic modular framework');
insert into users (first_name, last_name, story) values ('Humberto', 'Scudamore', 'Grass-roots optimal parallelism');
insert into users (first_name, last_name, story) values ('Evyn', 'Carrane', 'Exclusive well-modulated superstructure');
insert into users (first_name, last_name, story) values ('Martie', 'Hucks', 'Virtual 24/7 migration');
insert into users (first_name, last_name, story) values ('Eirena', 'Verrall', 'Stand-alone well-modulated leverage');
insert into users (first_name, last_name, story) values ('Shirlee', 'Troak', 'Re-engineered high-level Graphic Interface');
insert into users (first_name, last_name, story) values ('Daffie', 'Bowlesworth', 'Secured encompassing extranet');
insert into users (first_name, last_name, story) values ('Pietra', 'Mouncher', 'Digitized content-based firmware');
insert into users (first_name, last_name, story) values ('Kessia', 'Corten', 'Reduced analyzing migration');
insert into users (first_name, last_name, story) values ('Mordecai', 'Wheater', 'Organized fault-tolerant product');
insert into users (first_name, last_name, story) values ('Faun', 'Haddy', 'Compatible dynamic info-mediaries');
insert into users (first_name, last_name, story) values ('Nonna', 'Showler', 'Upgradable leading edge hierarchy');
insert into users (first_name, last_name, story) values ('My', 'Whyman', 'Progressive intermediate help-desk');
insert into users (first_name, last_name, story) values ('Tynan', 'Cowin', 'Reduced neutral migration');
insert into users (first_name, last_name, story) values ('Clarabelle', 'Aymer', 'Intuitive needs-based circuit');
insert into users (first_name, last_name, story) values ('Aloysia', 'Aloigi', 'Operative systematic paradigm');
insert into users (first_name, last_name, story) values ('Meryl', 'Hammett', 'Distributed zero defect secured line');
insert into users (first_name, last_name, story) values ('Fergus', 'Wiffen', 'Object-based intermediate firmware');
insert into users (first_name, last_name, story) values ('Dewain', 'Tesmond', 'Innovative client-driven protocol');
insert into users (first_name, last_name, story) values ('Corabelle', 'Crumby', 'Operative local methodology');
insert into users (first_name, last_name, story) values ('Eada', 'Bubb', 'Robust leading edge core');
insert into users (first_name, last_name, story) values ('Anthe', 'Denslow', 'Decentralized uniform challenge');
insert into users (first_name, last_name, story) values ('Cristal', 'Kitter', 'Decentralized mobile architecture');
insert into users (first_name, last_name, story) values ('Zandra', 'Buxsey', 'User-centric global hierarchy');
insert into users (first_name, last_name, story) values ('Freddy', 'Shellshear', 'Switchable 3rd generation frame');
insert into users (first_name, last_name, story) values ('Urbanus', 'Abrahmer', 'Advanced real-time utilisation');
insert into users (first_name, last_name, story) values ('Randolf', 'O''Dowgaine', 'Devolved encompassing service-desk');
insert into users (first_name, last_name, story) values ('Alanson', 'Stretton', 'Visionary actuating complexity');
insert into users (first_name, last_name, story) values ('Othello', 'Melmore', 'Cross-group executive hardware');
insert into users (first_name, last_name, story) values ('Ignazio', 'Veall', 'Ameliorated homogeneous Graphic Interface');
insert into users (first_name, last_name, story) values ('Brnaba', 'Waison', 'Networked actuating workforce');
insert into users (first_name, last_name, story) values ('Henrie', 'Lewens', 'Object-based holistic methodology');
insert into users (first_name, last_name, story) values ('Delilah', 'Culpan', 'Decentralized transitional instruction set');
insert into users (first_name, last_name, story) values ('Rakel', 'Stannis', 'Front-line attitude-oriented projection');
insert into users (first_name, last_name, story) values ('Darill', 'Lorey', 'Operative national alliance');
insert into users (first_name, last_name, story) values ('Orion', 'Sproul', 'Function-based multimedia functionalities');
insert into users (first_name, last_name, story) values ('Smith', 'Parysowna', 'Intuitive non-volatile application');
insert into users (first_name, last_name, story) values ('Veradis', 'Aylett', 'Programmable holistic groupware');
insert into users (first_name, last_name, story) values ('Thea', 'Henderson', 'Self-enabling modular framework');
insert into users (first_name, last_name, story) values ('Rachelle', 'Bloor', 'Managed multimedia throughput');
insert into users (first_name, last_name, story) values ('Robbie', 'Barbier', 'Multi-layered attitude-oriented alliance');
insert into users (first_name, last_name, story) values ('Frederich', 'Fenney', 'Innovative neutral info-mediaries');
insert into users (first_name, last_name, story) values ('Templeton', 'Brager', 'Adaptive well-modulated website');
insert into users (first_name, last_name, story) values ('Ryun', 'Phettis', 'Decentralized static migration');
insert into users (first_name, last_name, story) values ('Allyson', 'Blunn', 'Monitored leading edge migration');
insert into users (first_name, last_name, story) values ('Royce', 'Darker', 'Synchronised web-enabled adapter');
insert into users (first_name, last_name, story) values ('Marna', 'Vitet', 'Down-sized holistic policy');
insert into users (first_name, last_name, story) values ('Neilla', 'Deevey', 'Networked fault-tolerant service-desk');
insert into users (first_name, last_name, story) values ('Boris', 'Bradburne', 'Enhanced tertiary approach');
insert into users (first_name, last_name, story) values ('Elvin', 'Sagg', 'Function-based full-range strategy');
insert into users (first_name, last_name, story) values ('Babbie', 'Ferraro', 'Adaptive hybrid pricing structure');
insert into users (first_name, last_name, story) values ('Andriana', 'Kimmel', 'Open-architected foreground open system');
insert into users (first_name, last_name, story) values ('Helaina', 'Jelleman', 'Realigned systemic portal');
insert into users (first_name, last_name, story) values ('Kerstin', 'Woodfield', 'Secured actuating benchmark');
insert into users (first_name, last_name, story) values ('Felicdad', 'Twaits', 'Distributed fresh-thinking info-mediaries');
insert into users (first_name, last_name, story) values ('Tomi', 'Fuchs', 'Fully-configurable multi-state complexity');
insert into users (first_name, last_name, story) values ('Mame', 'Mc Ilwrick', 'Automated fault-tolerant system engine');
insert into users (first_name, last_name, story) values ('Ben', 'Gobel', 'Re-contextualized solution-oriented product');
insert into users (first_name, last_name, story) values ('Beniamino', 'Bastiman', 'Phased logistical challenge');
insert into users (first_name, last_name, story) values ('Lindy', 'Hadye', 'Optimized responsive interface');

CREATE EXTENSION IF NOT EXISTS pg_trgm;

CREATE INDEX search_with_weight_idx
ON users
USING GIN (search_with_weight);

UPDATE users
SET search_with_weight = setweight(to_tsvector(first_name), 'A') ||
setweight(to_tsvector(last_name), 'B') || setweight(to_tsvector(coalesce(story, '')), 'C');

CREATE FUNCTION users_tsvector_trigger()
RETURNS TRIGGER AS $$
BEGIN
    NEW.search_with_weight :=
        setweight(to_tsvector('simple', coalesce(NEW.first_name, '')), 'A') ||
        setweight(to_tsvector('simple', coalesce(NEW.last_name, '')), 'B') ||
        setweight(to_tsvector('english', coalesce(NEW.story, '')), 'C');
    RETURN NEW;
END
$$ LANGUAGE plpgsql;

CREATE TRIGGER tsvectorupdate
BEFORE INSERT OR UPDATE ON users
FOR EACH ROW EXECUTE FUNCTION users_tsvector_trigger();


